diff --git a/buffer/src/main/java/io/netty/buffer/ReadOnlyAbstractByteBuf.java b/buffer/src/main/java/io/netty/buffer/ReadOnlyAbstractByteBuf.java
index ca3b709e420..8dacab67983 100644
--- a/buffer/src/main/java/io/netty/buffer/ReadOnlyAbstractByteBuf.java
+++ b/buffer/src/main/java/io/netty/buffer/ReadOnlyAbstractByteBuf.java
@@ -23,6 +23,7 @@ final class ReadOnlyAbstractByteBuf extends ReadOnlyByteBuf {
 
     ReadOnlyAbstractByteBuf(AbstractByteBuf buffer) {
         super(buffer);
+        assert buffer.unwrap() == null || buffer.unwrap() instanceof AbstractByteBuf;
     }
 
     @Override
diff --git a/buffer/src/main/java/io/netty/buffer/Unpooled.java b/buffer/src/main/java/io/netty/buffer/Unpooled.java
index 708aaa35efa..a388b1816a6 100644
--- a/buffer/src/main/java/io/netty/buffer/Unpooled.java
+++ b/buffer/src/main/java/io/netty/buffer/Unpooled.java
@@ -702,7 +702,10 @@ public static ByteBuf unmodifiableBuffer(ByteBuf buffer) {
     }
 
     private static ReadOnlyByteBuf newReadyOnlyBuffer(ByteBuf buffer) {
-        return buffer instanceof AbstractByteBuf ?
+        // We can only use ReadOnlyAbstractByteBuf if we either have nothing to unwrap or the unwrapped buffer is of
+        // type AbstractByteBuf. Otherwise we will produce a CCE later.
+        return buffer instanceof AbstractByteBuf && (
+                buffer.unwrap() == null || buffer.unwrap() instanceof AbstractByteBuf) ?
                 new ReadOnlyAbstractByteBuf((AbstractByteBuf) buffer) :
                 new ReadOnlyByteBuf(buffer);
     }
