diff --git a/buildSrc/src/main/kotlin/TaskExtensions.kt b/buildSrc/src/main/kotlin/TaskExtensions.kt
new file mode 100644
index 0000000000..50331722aa
--- /dev/null
+++ b/buildSrc/src/main/kotlin/TaskExtensions.kt
@@ -0,0 +1,7 @@
+import org.gradle.api.tasks.javadoc.Javadoc
+import org.gradle.external.javadoc.StandardJavadocDocletOptions
+
+/** Applies the standard doclet options. */
+fun Javadoc.javadocDocletOptions(block: StandardJavadocDocletOptions.() -> Unit) {
+    (options as StandardJavadocDocletOptions).apply(block)
+}
diff --git a/buildSrc/src/main/kotlin/mockito.publication-conventions.gradle.kts b/buildSrc/src/main/kotlin/mockito.publication-conventions.gradle.kts
index ded6526dfa..ffe7531e8b 100644
--- a/buildSrc/src/main/kotlin/mockito.publication-conventions.gradle.kts
+++ b/buildSrc/src/main/kotlin/mockito.publication-conventions.gradle.kts
@@ -153,8 +153,11 @@ tasks.withType<GenerateModuleMetadata>().configureEach {
 
 // https://docs.gradle.org/current/userguide/signing_plugin.html
 signing {
-    System.getenv("PGP_KEY")?.takeIf { it.isNotBlank() }?.let { pgpKey ->
-        useInMemoryPgpKeys(pgpKey, System.getenv("PGP_PWD"))
+    if (providers.environmentVariable("PGP_KEY").isPresent) {
+        useInMemoryPgpKeys(
+            providers.environmentVariable("PGP_KEY").orNull,
+            providers.environmentVariable("PGP_PWD").orNull
+        )
         sign(publishing.publications)
     }
 }
diff --git a/buildSrc/src/main/kotlin/mockito.test-conventions.gradle.kts b/buildSrc/src/main/kotlin/mockito.test-conventions.gradle.kts
index f36fb3fe91..6574d44339 100644
--- a/buildSrc/src/main/kotlin/mockito.test-conventions.gradle.kts
+++ b/buildSrc/src/main/kotlin/mockito.test-conventions.gradle.kts
@@ -24,7 +24,7 @@ tasks {
             include("**/*Test.class")
 
             if (JavaVersion.current().isCompatibleWith(JavaVersion.VERSION_17)
-                && System.getenv("MEMBER_ACCESSOR") == "member-accessor-reflection") {
+                && providers.environmentVariable("MEMBER_ACCESSOR").orNull == "member-accessor-reflection") {
                 jvmArgs("--add-opens=java.base/java.lang=ALL-UNNAMED")
             }
         }
diff --git a/mockito-bom/build.gradle b/mockito-bom/build.gradle.kts
similarity index 78%
rename from mockito-bom/build.gradle
rename to mockito-bom/build.gradle.kts
index 81d86d3dc8..8ed867a9cb 100644
--- a/mockito-bom/build.gradle
+++ b/mockito-bom/build.gradle.kts
@@ -10,11 +10,12 @@ if (!base.archivesName.get().startsWith("mockito-")) {
     base.archivesName = "mockito-" + project.name
 }
 
+val mockitoExtensions: Set<Project> = project(":mockito-extensions").subprojects
 dependencies {
     constraints {
         api(project(":mockito-core"))
 
-        project(":mockito-extensions").subprojects.forEach {
+        mockitoExtensions.forEach {
             api(it)
         }
     }
diff --git a/mockito-core/build.gradle b/mockito-core/build.gradle
deleted file mode 100644
index 8fae158f50..0000000000
--- a/mockito-core/build.gradle
+++ /dev/null
@@ -1,62 +0,0 @@
-plugins {
-    id("mockito.library-conventions")
-    id("mockito.java-backward-compatibility-checks-conventions")
-    id("mockito.javadoc-conventions")
-}
-
-description = 'Mockito mock objects library core API and implementation'
-base.archivesName = 'mockito-core'
-
-apply from: "$rootDir/gradle/coverage.gradle"
-apply from: "inline-mock.gradle"
-apply from: "testing.gradle"
-
-configurations {
-    testUtil //TODO move to separate project
-    // Putting 'provided' dependencies on test compile and runtime classpath.
-    testCompileOnly.extendsFrom(compileOnly)
-    testRuntimeOnly.extendsFrom(compileOnly)
-}
-
-dependencies {
-    api libs.bytebuddy, libs.bytebuddy.agent
-
-    compileOnly libs.junit4, libs.hamcrest, libs.opentest4j
-    implementation libs.objenesis
-
-    testImplementation libs.assertj
-    testImplementation libs.junit.jupiter.api
-    testImplementation libs.junit.jupiter.params
-
-    testUtil sourceSets.test.output
-}
-
-mockitoJavadoc {
-    title = "Mockito ${project.version} API"
-    docTitle = """<h1><a href="org/mockito/Mockito.html">Click to see examples</a>. Mockito ${project.version} API.</h1>"""
-}
-
-tasks.named("jar", Jar) {
-    bundle { // this: BundleTaskExtension
-        classpath = project.configurations.compileClasspath
-        bnd(
-            'Bundle-Name': 'Mockito Mock Library for Java. Core bundle requires Byte Buddy and Objenesis.',
-            'Bundle-SymbolicName': 'org.mockito.mockito-core',
-            'Bundle-Version': "\${version_cleanup;${project.version}}",
-            '-versionpolicy': '[${version;==;${@}},${version;+;${@}})',
-            'Export-Package': "org.mockito.internal.*;status=INTERNAL;mandatory:=status;version=${archiveVersion.get()},org.mockito.*;version=${archiveVersion.get()}",
-            'Import-Package': [
-                'net.bytebuddy.*;version="[1.6.0,2.0)"',
-                'junit.*;resolution:=optional',
-                'org.junit.*;resolution:=optional',
-                'org.hamcrest;resolution:=optional',
-                'org.objenesis;version="[3.1,4.0)"',
-                'org.opentest4j.*;resolution:=optional',
-                'org.mockito.*'
-            ].join(','),
-            '-removeheaders': 'Private-Package',
-            'Automatic-Module-Name': 'org.mockito',
-            '-noextraheaders': 'true'
-        )
-    }
-}
diff --git a/mockito-core/build.gradle.kts b/mockito-core/build.gradle.kts
new file mode 100644
index 0000000000..38fb522c0c
--- /dev/null
+++ b/mockito-core/build.gradle.kts
@@ -0,0 +1,202 @@
+import com.android.build.gradle.internal.tasks.factory.dependsOn
+
+plugins {
+    id("mockito.library-conventions")
+    id("mockito.java-backward-compatibility-checks-conventions")
+    id("mockito.javadoc-conventions")
+    id("java-test-fixtures")
+}
+
+description = "Mockito mock objects library core API and implementation"
+base.archivesName = "mockito-core"
+
+apply {
+    from(rootProject.file("gradle/coverage.gradle"))
+}
+
+configurations {
+    // Putting 'provided' dependencies on testCompileOnly and testRuntimeOnly classpath.
+    testCompileOnly.configure {
+        extendsFrom(compileOnly.get())
+    }
+    testRuntimeOnly.configure {
+        extendsFrom(compileOnly.get())
+    }
+}
+
+dependencies {
+    api(libs.bytebuddy)
+    api(libs.bytebuddy.agent)
+
+    compileOnly(libs.junit4)
+    compileOnly(libs.hamcrest)
+    compileOnly(libs.opentest4j)
+    implementation(libs.objenesis)
+
+    testImplementation(libs.assertj)
+    testImplementation(libs.junit.jupiter.api)
+    testImplementation(libs.junit.jupiter.params)
+
+    testFixturesImplementation(libs.assertj)
+    testFixturesImplementation(libs.objenesis)
+    testFixturesCompileOnly(libs.junit4)
+}
+
+mockitoJavadoc {
+    title = "Mockito ${project.version} API"
+    docTitle =
+        """<h1><a href="org/mockito/Mockito.html">Click to see examples</a>. Mockito ${project.version} API.</h1>"""
+}
+
+val generatedInlineResource: Provider<Directory> = layout.buildDirectory.dir("generated/resources/inline/java")
+sourceSets {
+    main {
+        resources {
+            output.dir(generatedInlineResource)
+        }
+    }
+}
+
+tasks {
+    val copyMockMethodDispatcher by registering(Copy::class) {
+        dependsOn(compileJava)
+
+        from(sourceSets.main.flatMap { it.java.classesDirectory }
+            .map { it.file("org/mockito/internal/creation/bytebuddy/inject/MockMethodDispatcher.class") })
+        into(generatedInlineResource.map { it.dir("org/mockito/internal/creation/bytebuddy/inject") })
+
+        rename("(.+)\\.class", "$1.raw")
+    }
+    classes.dependsOn(copyMockMethodDispatcher)
+
+
+    jar {
+        exclude(
+            "org/mockito/internal/creation/bytebuddy/inject/package-info.class",
+            "org/mockito/internal/creation/bytebuddy/inject/MockMethodDispatcher.class",
+        )
+        manifest {
+            attributes(
+                "Premain-Class" to "org.mockito.internal.PremainAttach",
+                "Can-Retransform-Classes" to "true",
+            )
+        }
+
+        bundle { // this: BundleTaskExtension
+            classpath(project.configurations.compileClasspath)
+            bnd(
+                """
+                # Bnd instructions for the Mockito core bundle.
+
+                # Set a bundle name slightly different from project description.
+                Bundle-Name: Mockito Mock Library for Java. Core bundle requires Byte Buddy and Objenesis.
+
+                # Set the Bundle-SymbolicName to "org.mockito.mockito-core".
+                # Otherwise bnd plugin will use archiveClassifier by default.
+                Bundle-SymbolicName: org.mockito.mockito-core
+
+                # Version rules for the bundle.
+                # https://bnd.bndtools.org/macros/version_cleanup.html
+                Bundle-Version: ${'$'}{version_cleanup;${project.version}}
+
+                # Set bundle license
+                Bundle-License: MIT
+
+                # Export rules for public and internal packages
+                # https://bnd.bndtools.org/heads/export_package.html
+                Export-Package: \
+                    org.mockito.internal.*;status=INTERNAL;mandatory:=status;version=${archiveVersion.get()}, \
+                    org.mockito.*;version=${archiveVersion.get()}
+
+                # General rules for package import
+                # https://bnd.bndtools.org/heads/import_package.html
+                # Override the default version policy to allow for a range of versions.
+                # At this point it's unclear whether `versionpolicy` is deprecated, here's
+                # some relevant pages on versions
+                # https://bnd.bndtools.org/chapters/170-versioning.html
+                # https://bnd.bndtools.org/macros/version.html
+                # https://bnd.bndtools.org/macros/versionmask.html
+                # https://bnd.bndtools.org/macros/range.html
+                -versionpolicy: [${'$'}{version;==;${'$'}{@}},${'$'}{version;+;${'$'}{@}})
+                Import-Package: \
+                    net.bytebuddy.*;version="[1.6.0,2.0)", \
+                    junit.*;resolution:=optional, \
+                    org.junit.*;resolution:=optional, \
+                    org.hamcrest;resolution:=optional, \
+                    org.objenesis;version="[3.1,4.0)", \
+                    org.opentest4j.*;resolution:=optional, \
+                    org.mockito.*
+
+                # Don't add the Private-Package header.
+                # See https://bnd.bndtools.org/instructions/removeheaders.html
+                -removeheaders: Private-Package
+
+                # Configures the automatic module name for Java 9+.
+                Automatic-Module-Name: org.mockito
+
+                # Don't add all the extra headers bnd normally adds.
+                # See https://bnd.bndtools.org/instructions/noextraheaders.html
+                -noextraheaders: true
+            """.trimIndent()
+            )
+        }
+    }
+
+    test {
+        val java11 = providers.environmentVariable("SIMULATE_JAVA11")
+        if (java11.isPresent) {
+            logger.info("$path - use Java11 simulation: $java11")
+            systemProperty("org.mockito.internal.noUnsafeInjection", java11.get())
+        }
+    }
+}
+
+//<editor-fold defaultstate="collapsed" desc="Environment-based Mockito extension configuration for tests">
+val mockitoExtConfigFiles = listOf(
+    mockitoExtensionConfigFile(project, "org.mockito.plugins.MockMaker"),
+    mockitoExtensionConfigFile(project, "org.mockito.plugins.MemberAccessor"),
+)
+
+val createTestResources by tasks.registering {
+    outputs.files(mockitoExtConfigFiles)
+    doLast {
+        // Configure MockMaker from environment (if specified), otherwise use default
+        configureMockitoExtensionFromCi(project, "org.mockito.plugins.MockMaker", "MOCK_MAKER")
+
+        // Configure MemberAccessor from environment (if specified), otherwise use default
+        configureMockitoExtensionFromCi(project, "org.mockito.plugins.MemberAccessor", "MEMBER_ACCESSOR")
+    }
+}
+
+sourceSets.test {
+    resources {
+        output.dir(
+            layout.buildDirectory.dir("generated/resources/ext-config/test"),
+            "builtBy" to createTestResources
+        )
+    }
+}
+
+fun Task.configureMockitoExtensionFromCi(
+    project: Project,
+    mockitoExtension: String,
+    ciMockitoExtensionEnvVarName: String,
+) {
+    val mockitoExtConfigFile = mockitoExtensionConfigFile(project, mockitoExtension)
+    val extEnvVar = project.providers.environmentVariable(ciMockitoExtensionEnvVarName)
+    if (extEnvVar.isPresent && !extEnvVar.get().endsWith("default")) {
+        logger.info("Using $mockitoExtension ${extEnvVar.get()}")
+        mockitoExtConfigFile.run {
+            parentFile.mkdirs()
+            createNewFile()
+            writeText(extEnvVar.get())
+        }
+    } else {
+        logger.info("Using default $mockitoExtension")
+    }
+}
+
+fun mockitoExtensionConfigFile(project: Project, mockitoExtension: String) =
+    file(project.layout.buildDirectory.dir("generated/resources/ext-config/test/mockito-extensions/$mockitoExtension"))
+//</editor-fold>
+
diff --git a/mockito-core/inline-mock.gradle b/mockito-core/inline-mock.gradle
deleted file mode 100644
index 25adac8c7b..0000000000
--- a/mockito-core/inline-mock.gradle
+++ /dev/null
@@ -1,24 +0,0 @@
-tasks.register('copyMockMethodDispatcher', Copy) {
-    dependsOn compileJava
-
-    from "${sourceSets.main.java.classesDirectory.get()}/org/mockito/internal/creation/bytebuddy/inject/MockMethodDispatcher.class"
-    into layout.buildDirectory.dir("generated/resources/inline/org/mockito/internal/creation/bytebuddy/inject")
-
-    rename '(.+)\\.class', '$1.raw'
-}
-classes.dependsOn("copyMockMethodDispatcher")
-
-sourceSets.main {
-    resources {
-        output.dir(layout.buildDirectory.dir("generated/resources/inline"))
-    }
-}
-
-tasks.named("jar", Jar) {
-    exclude("org/mockito/internal/creation/bytebuddy/inject/package-info.class")
-    exclude("org/mockito/internal/creation/bytebuddy/inject/MockMethodDispatcher.class")
-    manifest {
-        attributes 'Premain-Class': 'org.mockito.internal.PremainAttach'
-        attributes 'Can-Retransform-Classes': 'true'
-    }
-}
diff --git a/mockito-core/testing.gradle b/mockito-core/testing.gradle
deleted file mode 100644
index 949b0f2cfc..0000000000
--- a/mockito-core/testing.gradle
+++ /dev/null
@@ -1,54 +0,0 @@
-def java11 = System.env.SIMULATE_JAVA11
-if (java11 != null) {
-    tasks.named("test", Test) {
-        logger.info("$it.path - use Java11 simluation: ${java11}")
-        systemProperty "org.mockito.internal.noUnsafeInjection", java11
-    }
-}
-
-tasks.register("createTestResources") {
-    doLast {
-        // Configure MockMaker from environment (if specified), otherwise use default
-        def mockMakerFile = new File("$sourceSets.test.output.resourcesDir/mockito-extensions/org.mockito.plugins.MockMaker")
-        if (System.env.MOCK_MAKER != null && !System.env.MOCK_MAKER.endsWith("default")) {
-            logger.info("Using MockMaker ${System.env.MOCK_MAKER}")
-            mockMakerFile.parentFile.mkdirs()
-            mockMakerFile.createNewFile()
-            mockMakerFile.write(System.env.MOCK_MAKER)
-        } else {
-            logger.info("Using default MockMaker")
-        }
-
-        // Configure MemberAccessor from environment (if specified), otherwise use default
-        def memberAccessorFile = new File("$sourceSets.test.output.resourcesDir/mockito-extensions/org.mockito.plugins.MemberAccessor")
-        if (System.env.MEMBER_ACCESSOR != null  && !System.env.MEMBER_ACCESSOR.endsWith("default")) {
-            logger.info("Using MemberAccessor ${System.env.MEMBER_ACCESSOR}")
-            memberAccessorFile.parentFile.mkdirs()
-            memberAccessorFile.createNewFile()
-            memberAccessorFile.write(System.env.MEMBER_ACCESSOR)
-        } else {
-            logger.info("Using default MemberAccessor")
-        }
-    }
-}
-
-tasks.register("removeTestResources"){
-    doLast {
-        def mockMakerFile = new File("$sourceSets.test.output.resourcesDir/mockito-extensions/org.mockito.plugins.MockMaker")
-        if (mockMakerFile.exists()) {
-            mockMakerFile.delete()
-        }
-
-        def memberAccessorFile = new File("$sourceSets.test.output.resourcesDir/mockito-extensions/org.mockito.plugins.MemberAccessor")
-        if (memberAccessorFile.exists()) {
-            memberAccessorFile.delete()
-        }
-    }
-}
-
-tasks.named("processTestResources") {
-    finalizedBy(createTestResources)
-}
-tasks.named("test") {
-    finalizedBy(removeTestResources)
-}
diff --git a/mockito-extensions/mockito-android/build.gradle b/mockito-extensions/mockito-android/build.gradle.kts
similarity index 56%
rename from mockito-extensions/mockito-android/build.gradle
rename to mockito-extensions/mockito-android/build.gradle.kts
index 2b8bb1f909..58c61f11af 100644
--- a/mockito-extensions/mockito-android/build.gradle
+++ b/mockito-extensions/mockito-android/build.gradle.kts
@@ -6,8 +6,10 @@ plugins {
 description = "Mockito for Android"
 
 dependencies {
-    api project(":mockito-core")
-    implementation libs.bytebuddy.android
+    api(project(":mockito-core"))
+    implementation(libs.bytebuddy.android)
 }
 
-tasks.javadoc.enabled = false
+tasks.javadoc {
+    isEnabled = false
+}
diff --git a/mockito-extensions/mockito-errorprone/build.gradle b/mockito-extensions/mockito-errorprone/build.gradle
deleted file mode 100644
index 4ea12895a8..0000000000
--- a/mockito-extensions/mockito-errorprone/build.gradle
+++ /dev/null
@@ -1,40 +0,0 @@
-plugins {
-    id("mockito.library-conventions")
-}
-
-description = "ErrorProne plugins for Mockito"
-
-dependencies {
-    compileOnly libs.autoservice
-    annotationProcessor libs.autoservice
-
-    implementation project(":mockito-core")
-    implementation libs.errorprone
-
-    testImplementation 'junit:junit:4.13.2'
-    testImplementation libs.errorprone.test.api
-}
-
-test {
-    inputs.files(configurations.errorproneJavac).withNormalizer(ClasspathNormalizer)
-    jvmArgs += "-Xbootclasspath/a:${configurations.errorproneJavac.asPath}"
-    jvmArgs += "--add-exports=jdk.compiler/com.sun.tools.javac.api=ALL-UNNAMED"
-    jvmArgs += "--add-exports=jdk.compiler/com.sun.tools.javac.type=ALL-UNNAMED"
-    jvmArgs += "--add-exports=jdk.compiler/com.sun.tools.javac.file=ALL-UNNAMED"
-    jvmArgs += "--add-exports=jdk.compiler/com.sun.tools.javac.util=ALL-UNNAMED"
-    jvmArgs += "--add-exports=jdk.compiler/com.sun.tools.javac.tree=ALL-UNNAMED"
-    jvmArgs += "--add-exports=jdk.compiler/com.sun.tools.javac.main=ALL-UNNAMED"
-    jvmArgs += "--add-exports=jdk.compiler/com.sun.tools.javac.comp=ALL-UNNAMED"
-    jvmArgs += "--add-exports=jdk.compiler/com.sun.tools.javac.code=ALL-UNNAMED"
-    jvmArgs += "--add-exports=jdk.compiler/com.sun.tools.javac.parser=ALL-UNNAMED"
-}
-
-tasks.withType(JavaCompile).configureEach {
-    options.compilerArgs << "--add-exports=jdk.compiler/com.sun.tools.javac.code=ALL-UNNAMED"
-    options.compilerArgs << "--add-exports=jdk.compiler/com.sun.tools.javac.tree=ALL-UNNAMED"
-    options.compilerArgs << "--add-exports=jdk.compiler/com.sun.tools.javac.util=ALL-UNNAMED"
-}
-
-tasks.withType(Javadoc).configureEach {
-    options.addBooleanOption("-add-exports=jdk.compiler/com.sun.tools.javac.code=ALL-UNNAMED", true)
-}
diff --git a/mockito-extensions/mockito-errorprone/build.gradle.kts b/mockito-extensions/mockito-errorprone/build.gradle.kts
new file mode 100644
index 0000000000..16751515c5
--- /dev/null
+++ b/mockito-extensions/mockito-errorprone/build.gradle.kts
@@ -0,0 +1,57 @@
+plugins {
+    id("mockito.library-conventions")
+}
+
+description = "ErrorProne plugins for Mockito"
+
+dependencies {
+    compileOnly(libs.autoservice)
+    annotationProcessor(libs.autoservice)
+
+    implementation(project(":mockito-core"))
+    implementation(libs.errorprone)
+
+    testImplementation("junit:junit:4.13.2")
+    testImplementation(libs.errorprone.test.api)
+}
+
+tasks {
+    test {
+        inputs.files(configurations.errorproneJavac).withNormalizer(ClasspathNormalizer::class)
+        jvmArgumentProviders.add(
+            CommandLineArgumentProvider {
+                listOf(
+                    "-Xbootclasspath/a:${configurations.errorproneJavac.get().asPath}",
+                    "--add-exports=jdk.compiler/com.sun.tools.javac.api=ALL-UNNAMED",
+                    "--add-exports=jdk.compiler/com.sun.tools.javac.type=ALL-UNNAMED",
+                    "--add-exports=jdk.compiler/com.sun.tools.javac.file=ALL-UNNAMED",
+                    "--add-exports=jdk.compiler/com.sun.tools.javac.util=ALL-UNNAMED",
+                    "--add-exports=jdk.compiler/com.sun.tools.javac.tree=ALL-UNNAMED",
+                    "--add-exports=jdk.compiler/com.sun.tools.javac.main=ALL-UNNAMED",
+                    "--add-exports=jdk.compiler/com.sun.tools.javac.comp=ALL-UNNAMED",
+                    "--add-exports=jdk.compiler/com.sun.tools.javac.code=ALL-UNNAMED",
+                    "--add-exports=jdk.compiler/com.sun.tools.javac.parser=ALL-UNNAMED",
+                )
+            }
+        )
+    }
+
+    withType<JavaCompile> {
+        options.compilerArgs.addAll(
+            listOf(
+                "--add-exports=jdk.compiler/com.sun.tools.javac.code=ALL-UNNAMED",
+                "--add-exports=jdk.compiler/com.sun.tools.javac.tree=ALL-UNNAMED",
+                "--add-exports=jdk.compiler/com.sun.tools.javac.util=ALL-UNNAMED"
+            )
+        )
+    }
+
+    withType<Javadoc> {
+        javadocDocletOptions {
+            addBooleanOption(
+                "-add-exports=jdk.compiler/com.sun.tools.javac.code=ALL-UNNAMED",
+                true
+            )
+        }
+    }
+}
diff --git a/mockito-extensions/mockito-junit-jupiter/build.gradle b/mockito-extensions/mockito-junit-jupiter/build.gradle
deleted file mode 100644
index 10068f8fdc..0000000000
--- a/mockito-extensions/mockito-junit-jupiter/build.gradle
+++ /dev/null
@@ -1,76 +0,0 @@
-import aQute.bnd.gradle.Resolve
-
-plugins {
-    id("mockito.library-conventions")
-    id("mockito.javadoc-conventions")
-}
-
-description = "Mockito JUnit 5 support"
-
-dependencies {
-    api project(":mockito-core")
-    implementation libs.junit.jupiter.api
-    testImplementation libs.assertj
-    testImplementation libs.junit.platform.launcher
-    testRuntimeOnly libs.junit.jupiter.engine
-}
-
-tasks.withType(Test).configureEach {
-    useJUnitPlatform()
-}
-
-mockitoJavadoc {
-    title = "Mockito JUnit Jupiter ${project.version} API"
-    docTitle = """<h1>Mockito JUnit Jupiter ${project.version} API.</h1>"""
-}
-
-jar {
-    bundle { // this: BundleTaskExtension
-        classpath = project.configurations.runtimeClasspath
-        bnd(
-            'Bundle-Name': 'Mockito Extension Library for JUnit 5.',
-            'Bundle-SymbolicName': 'org.mockito.junit-jupiter',
-            'Bundle-Version': "\${version_cleanup;${project.version}}",
-            '-versionpolicy': '[${version;==;${@}},${version;+;${@}})',
-            'Export-Package': "org.mockito.junit.jupiter.*;version=${archiveVersion.get()}",
-            '-removeheaders': 'Private-Package',
-            'Automatic-Module-Name': 'org.mockito.junit.jupiter',
-            '-noextraheaders': 'true',
-            '-export-apiguardian': 'org.mockito.internal.*'
-        )
-    }
-}
-
-// Bnd's Resolve task uses a properties file for its configuration. This
-// task writes out the properties necessary for it to verify the OSGi
-// metadata.
-def osgiProperties = tasks.register('osgiProperties', WriteProperties) {
-  destinationFile = layout.buildDirectory.file("verifyOSGiProperties.bndrun")
-  property('-standalone', true)
-  property('-runee', "JavaSE-${java.targetCompatibility}")
-  property('-runrequires', 'osgi.identity;filter:="(osgi.identity=org.mockito.junit-jupiter)"')
-}
-
-// Bnd's Resolve task is what verifies that a jar can be used in OSGi and
-// that its metadata is valid. If the metadata is invalid this task will
-// fail.
-def verifyOSGi = tasks.register('verifyOSGi', Resolve) {
-  getBndrun().value(osgiProperties.flatMap { it.destinationFile })
-  getOutputBndrun().set(layout.buildDirectory.file("resolvedOSGiProperties.bndrun"))
-  reportOptional = false
-}
-
-tasks.named('check') {
-  dependsOn(verifyOSGi)
-}
-
-tasks.named("javadoc", Javadoc) {
-    // Handle https://bugs.openjdk.org/browse/JDK-8274639
-    // Note : Might be solved by a toolchain launcher for the javadoc.
-    if (JavaVersion.current() >= JavaVersion.VERSION_18) {
-        options.addStringOption("-link-modularity-mismatch", "info")
-        options.links("https://junit.org/junit5/docs/${libs.versions.junit.jupiter.get()}/api/")
-    } else {
-        logger.info("Javadoc tool below 18, links to JUnit Jupiter javadocs was not added.")
-    }
-}
diff --git a/mockito-extensions/mockito-junit-jupiter/build.gradle.kts b/mockito-extensions/mockito-junit-jupiter/build.gradle.kts
new file mode 100644
index 0000000000..ddaeff2dc5
--- /dev/null
+++ b/mockito-extensions/mockito-junit-jupiter/build.gradle.kts
@@ -0,0 +1,105 @@
+import aQute.bnd.gradle.Resolve
+
+plugins {
+    id("mockito.library-conventions")
+    id("mockito.javadoc-conventions")
+}
+
+description = "Mockito JUnit 5 support"
+
+dependencies {
+    api(project(":mockito-core"))
+    implementation(libs.junit.jupiter.api)
+    testImplementation(libs.assertj)
+    testImplementation(libs.junit.platform.launcher)
+    testRuntimeOnly(libs.junit.jupiter.engine)
+}
+
+mockitoJavadoc {
+    title = "Mockito JUnit Jupiter ${project.version} API"
+    docTitle = """<h1>Mockito JUnit Jupiter ${project.version} API.</h1>"""
+}
+
+tasks {
+    withType<Test> {
+        useJUnitPlatform()
+    }
+
+    jar {
+        bundle { // this: BundleTaskExtension
+            classpath = project.configurations.runtimeClasspath.get()
+            bnd("""
+                # Bnd instructions for the Mockito Junit Jupiter.
+
+                # Set a bundle name slightly different from project description.
+                Bundle-Name: Mockito Extension Library for JUnit 5.
+
+                # Set the Bundle-SymbolicName to "org.mockito.junit-jupiter".
+                # Otherwise bnd plugin will use archiveClassifier by default.
+                Bundle-SymbolicName: org.mockito.junit-jupiter
+
+                # Version rules for the bundle.
+                # https://bnd.bndtools.org/macros/version_cleanup.html
+                Bundle-Version: ${'$'}{version_cleanup;${project.version}}
+
+                # Set bundle license
+                Bundle-License: MIT
+
+                # Export rules for public and internal packages
+                # https://bnd.bndtools.org/heads/export_package.html
+                Export-Package: org.mockito.junit.jupiter.*;version=${archiveVersion.get()}
+
+                # Don't add the Private-Package header.
+                # See https://bnd.bndtools.org/instructions/removeheaders.html
+                -removeheaders: Private-Package
+
+                # Configures the automatic module name for Java 9+.
+                Automatic-Module-Name: org.mockito.junit.jupiter
+
+                # Don't add all the extra headers bnd normally adds.
+                # See https://bnd.bndtools.org/instructions/noextraheaders.html
+                -noextraheaders: true
+
+                # Instruct the APIGuardianAnnotations how to operate.
+                # See https://bnd.bndtools.org/instructions/export-apiguardian.html
+                -export-apiguardian: org.mockito.internal.*
+            """.trimIndent())
+        }
+    }
+
+    // Bnd's Resolve task uses a properties file for its configuration. This
+    // task writes out the properties necessary for it to verify the OSGi
+    // metadata.
+    val osgiProperties by registering(WriteProperties::class) {
+        destinationFile.set(layout.buildDirectory.file("verifyOSGiProperties.bndrun"))
+        property("-standalone", true)
+        property("-runee", "JavaSE-${java.targetCompatibility}")
+        property("-runrequires", "osgi.identity;filter:=\"(osgi.identity=org.mockito.junit-jupiter)\"")
+    }
+
+    // Bnd's Resolve task is what verifies that a jar can be used in OSGi and
+    // that its metadata is valid. If the metadata is invalid, this task will
+    // fail.
+    val verifyOSGi by registering(Resolve::class) {
+        bndrun = osgiProperties.flatMap { it.destinationFile }
+        outputBndrun = layout.buildDirectory.file("resolvedOSGiProperties.bndrun")
+        isReportOptional = false
+    }
+
+    check {
+        dependsOn(verifyOSGi)
+    }
+
+    javadoc {
+        // Handle https://bugs.openjdk.org/browse/JDK-8274639
+        // Note: Might be solved by a toolchain launcher for the javadoc.
+        if (JavaVersion.current() >= JavaVersion.VERSION_18) {
+            javadocDocletOptions {
+                addStringOption("-link-modularity-mismatch", "info")
+                links("https://junit.org/junit5/docs/${libs.versions.junit.jupiter.get()}/api/")
+            }
+        } else {
+            logger.info("Javadoc tool below 18, links to JUnit Jupiter javadocs was not added.")
+        }
+    }
+}
diff --git a/mockito-extensions/mockito-proxy/build.gradle b/mockito-extensions/mockito-proxy/build.gradle.kts
similarity index 52%
rename from mockito-extensions/mockito-proxy/build.gradle
rename to mockito-extensions/mockito-proxy/build.gradle.kts
index ecd645efa5..64368c07ce 100644
--- a/mockito-extensions/mockito-proxy/build.gradle
+++ b/mockito-extensions/mockito-proxy/build.gradle.kts
@@ -5,9 +5,11 @@ plugins {
 description = "Mockito preconfigured proxy mock mock maker (to support interfaces without code generation)"
 
 dependencies {
-    implementation project(":mockito-core")
-    testImplementation libs.junit4
-    testImplementation libs.assertj
+    implementation(project(":mockito-core"))
+    testImplementation(libs.junit4)
+    testImplementation(libs.assertj)
 }
 
-tasks.javadoc.enabled = false
+tasks.javadoc {
+    isEnabled = false
+}
diff --git a/mockito-extensions/mockito-subclass/build.gradle b/mockito-extensions/mockito-subclass/build.gradle
deleted file mode 100644
index ac116e06b2..0000000000
--- a/mockito-extensions/mockito-subclass/build.gradle
+++ /dev/null
@@ -1,13 +0,0 @@
-plugins {
-    id("mockito.library-conventions")
-}
-
-description = "Mockito preconfigured subclass mock maker"
-
-dependencies {
-    api project(":mockito-core")
-    testImplementation libs.junit4
-    testImplementation libs.assertj
-}
-
-tasks.javadoc.enabled = false
diff --git a/mockito-extensions/mockito-subclass/build.gradle.kts b/mockito-extensions/mockito-subclass/build.gradle.kts
new file mode 100644
index 0000000000..b95d97684c
--- /dev/null
+++ b/mockito-extensions/mockito-subclass/build.gradle.kts
@@ -0,0 +1,15 @@
+plugins {
+    id("mockito.library-conventions")
+}
+
+description = "Mockito preconfigured subclass mock maker"
+
+dependencies {
+    api(project(":mockito-core"))
+    testImplementation(libs.junit4)
+    testImplementation(libs.assertj)
+}
+
+tasks.javadoc {
+    isEnabled = false
+}
diff --git a/mockito-integration-tests/extensions-tests/build.gradle b/mockito-integration-tests/extensions-tests/build.gradle
deleted file mode 100644
index 636ea49d32..0000000000
--- a/mockito-integration-tests/extensions-tests/build.gradle
+++ /dev/null
@@ -1,28 +0,0 @@
-plugins {
-    id("java")
-    id("mockito.test-conventions")
-}
-
-description = "End-to-end tests for Mockito and its extensions."
-
-dependencies {
-    testImplementation project(":mockito-core")
-    testImplementation project(":mockito-extensions:mockito-junit-jupiter")
-    testImplementation project(path: ':mockito-core', configuration: 'testUtil')
-    testImplementation libs.junit4
-    testImplementation libs.assertj
-    testImplementation libs.junit.jupiter.api
-    testRuntimeOnly libs.junit.jupiter.engine
-    testRuntimeOnly libs.junit.vintage.engine
-    testRuntimeOnly libs.junit.platform.launcher
-}
-
-tasks.withType(Test).configureEach {
-    useJUnitPlatform()
-}
-
-configurations.configureEach {
-    //TODO SF enable when #154 is implemented
-    //let's make those tests not use hamcrest
-    //exclude group: 'org.hamcrest', module: 'hamcrest-core'
-}
diff --git a/mockito-integration-tests/extensions-tests/build.gradle.kts b/mockito-integration-tests/extensions-tests/build.gradle.kts
new file mode 100644
index 0000000000..6c88678016
--- /dev/null
+++ b/mockito-integration-tests/extensions-tests/build.gradle.kts
@@ -0,0 +1,30 @@
+plugins {
+    id("java")
+    id("mockito.test-conventions")
+}
+
+description = "End-to-end tests for Mockito and its extensions."
+
+dependencies {
+    testImplementation(project(":mockito-core"))
+    testImplementation(project(":mockito-extensions:mockito-junit-jupiter"))
+    testImplementation(testFixtures(project(":mockito-core")))
+    testImplementation(libs.junit4)
+    testImplementation(libs.assertj)
+    testImplementation(libs.junit.jupiter.api)
+    testRuntimeOnly(libs.junit.jupiter.engine)
+    testRuntimeOnly(libs.junit.vintage.engine)
+    testRuntimeOnly(libs.junit.platform.launcher)
+}
+
+tasks {
+    withType<Test> {
+        useJUnitPlatform()
+    }
+}
+
+configurations.configureEach {
+    //TODO SF enable when #154 is implemented
+    //let's make those tests not use hamcrest
+    //exclude group: 'org.hamcrest', module: 'hamcrest-core'
+}
diff --git a/mockito-integration-tests/groovy-inline-tests/build.gradle b/mockito-integration-tests/groovy-inline-tests/build.gradle.kts
similarity index 56%
rename from mockito-integration-tests/groovy-inline-tests/build.gradle
rename to mockito-integration-tests/groovy-inline-tests/build.gradle.kts
index a2ddc09cbd..9e666b545d 100644
--- a/mockito-integration-tests/groovy-inline-tests/build.gradle
+++ b/mockito-integration-tests/groovy-inline-tests/build.gradle.kts
@@ -7,7 +7,7 @@ plugins {
 description = "Integration test for using mockito-inline with Groovy."
 
 dependencies {
-    testImplementation project(":mockito-core")
-    testImplementation libs.groovy
-    testImplementation libs.junit4
+    testImplementation(project(":mockito-core"))
+    testImplementation(libs.groovy)
+    testImplementation(libs.junit4)
 }
diff --git a/mockito-integration-tests/groovy-tests/build.gradle b/mockito-integration-tests/groovy-tests/build.gradle.kts
similarity index 54%
rename from mockito-integration-tests/groovy-tests/build.gradle
rename to mockito-integration-tests/groovy-tests/build.gradle.kts
index a926806c6f..d09ff7835d 100644
--- a/mockito-integration-tests/groovy-tests/build.gradle
+++ b/mockito-integration-tests/groovy-tests/build.gradle.kts
@@ -6,7 +6,7 @@ plugins {
 description = "Integration test for using Mockito from Groovy."
 
 dependencies {
-    testImplementation project(":mockito-core")
-    testImplementation libs.groovy
-    testImplementation libs.junit4
+    testImplementation(project(":mockito-core"))
+    testImplementation(libs.groovy)
+    testImplementation(libs.junit4)
 }
diff --git a/mockito-integration-tests/inline-mocks-tests/build.gradle b/mockito-integration-tests/inline-mocks-tests/build.gradle
deleted file mode 100644
index 8edb6592a9..0000000000
--- a/mockito-integration-tests/inline-mocks-tests/build.gradle
+++ /dev/null
@@ -1,27 +0,0 @@
-plugins {
-    id("java")
-    id("mockito.test-conventions")
-}
-
-description = "Mockito preconfigured inline mock maker (intermediate and to be superseeded by automatic usage in a future version)"
-
-dependencies {
-    implementation project(":mockito-core")
-    testImplementation libs.junit4
-    testImplementation libs.assertj
-}
-
-test {
-    if (JavaVersion.VERSION_17 <= JavaVersion.current()) {
-        // For Java 17: https://openjdk.org/jeps/403
-        // > Ignoring option --illegal-access=deny; support was removed in 17.0
-    } else if (JavaVersion.VERSION_16 <= JavaVersion.current()) {
-        // For Java 16: https://openjdk.org/jeps/396
-        // --illegal-access=deny is the default.
-    } else if (JavaVersion.VERSION_1_9 <= JavaVersion.current()) {
-        // For Java 9-15: https://openjdk.org/jeps/261#Relaxed-strong-encapsulation
-        jvmArgs '--illegal-access=deny'
-    }
-    //required by the "StressTest.java" and "OneLinerStubStressTest.java"
-    maxHeapSize '256m'
-}
diff --git a/mockito-integration-tests/inline-mocks-tests/build.gradle.kts b/mockito-integration-tests/inline-mocks-tests/build.gradle.kts
new file mode 100644
index 0000000000..4a1a4f9953
--- /dev/null
+++ b/mockito-integration-tests/inline-mocks-tests/build.gradle.kts
@@ -0,0 +1,28 @@
+plugins {
+    id("java")
+    id("mockito.test-conventions")
+}
+
+description = "Mockito preconfigured inline mock maker (intermediate and to be superseeded by automatic usage in a future version)"
+
+dependencies {
+    implementation(project(":mockito-core"))
+    testImplementation(libs.junit4)
+    testImplementation(libs.assertj)
+}
+tasks {
+    test {
+        if (JavaVersion.VERSION_17 <= JavaVersion.current()) {
+            // For Java 17: https://openjdk.org/jeps/403
+            // > Ignoring option --illegal-access=deny; support was removed in 17.0
+        } else if (JavaVersion.VERSION_16 <= JavaVersion.current()) {
+            // For Java 16: https://openjdk.org/jeps/396
+            // --illegal-access=deny is the default.
+        } else if (JavaVersion.VERSION_1_9 <= JavaVersion.current()) {
+            // For Java 9-15: https://openjdk.org/jeps/261#Relaxed-strong-encapsulation
+            jvmArgs("--illegal-access=deny")
+        }
+        //required by the "StressTest.java" and "OneLinerStubStressTest.java"
+        maxHeapSize = "256m"
+    }
+}
diff --git a/mockito-integration-tests/java-21-tests/build.gradle b/mockito-integration-tests/java-21-tests/build.gradle
deleted file mode 100644
index 5781e4a51f..0000000000
--- a/mockito-integration-tests/java-21-tests/build.gradle
+++ /dev/null
@@ -1,91 +0,0 @@
-plugins {
-    id("java")
-    id("mockito.test-conventions")
-}
-
-description = "Test suite for Java 21 Mockito"
-
-def bytebuddyAgentConf = configurations.create("bytebuddyAgent")
-
-dependencies {
-    implementation project(":mockito-core")
-    testImplementation libs.junit4
-    testImplementation libs.assertj
-    testImplementation project(path: ':mockito-core', configuration: 'testUtil')
-    bytebuddyAgent(libs.bytebuddy.agent) { setTransitive(false) }
-}
-
-java {
-    sourceCompatibility = JavaVersion.VERSION_21
-    targetCompatibility = JavaVersion.VERSION_21
-    toolchain {
-        languageVersion = JavaLanguageVersion.of(21)
-    }
-}
-
-tasks.register("test-with-bytebuddy-agent", Test) {
-    if (!JavaVersion.current().isCompatibleWith(JavaVersion.VERSION_21)) {
-        enabled = false
-    } else {
-        jvmArgs(
-            "-javaagent:${bytebuddyAgentConf.asPath}",
-//            "-Djdk.instrument.traceUsage",
-        )
-    }
-}
-
-tasks.register("test-with-mockito-agent", Test) {
-    dependsOn(':mockito-core:jar')
-    if (!JavaVersion.current().isCompatibleWith(JavaVersion.VERSION_21)) {
-        enabled = false
-    } else {
-        jvmArgs(
-            "-javaagent:${project(":mockito-core").tasks.jar.outputs.files.singleFile}",
-//            "-Djdk.instrument.traceUsage",
-        )
-    }
-    failIfStdErrWarningOnDynamicallyLoadedAgent(it)
-}
-
-tasks.named('test', Test) {
-//    dependsOn(
-//        "test-with-bytebuddy-agent",
-//        "test-with-mockito-agent",
-//    )
-    enabled JavaVersion.current().isCompatibleWith(JavaVersion.VERSION_21)
-
-    expectStdErrWhenDynamicallyLoadedAgent(it)
-}
-
-private static void failIfStdErrWarningOnDynamicallyLoadedAgent(Test testTask) {
-    def stderrMessages = new ArrayList<String>()
-    testTask.addTestOutputListener { descriptor, event ->
-        if (event.destination == TestOutputEvent.Destination.StdErr) {
-            stderrMessages.add(event.message)
-        }
-    }
-    testTask.doLast {
-        def stderrText = stderrMessages.join '\n'
-        if (stderrText.contains("A Java agent has been loaded dynamically")
-            && stderrText.contains("net.bytebuddy/byte-buddy-agent")
-            && stderrText.contains("If a serviceability tool is in use, please run with -XX:+EnableDynamicAgentLoading to hide this warning")
-        ) {
-            throw new GradleException("JDK should no emit warning when mockito is set as agent and -XX:+EnableDynamicAgentLoading is not set")
-        }
-    }
-}
-
-private static void expectStdErrWhenDynamicallyLoadedAgent(Test testTask) {
-    def stderrMessages = new ArrayList<String>()
-    testTask.addTestOutputListener { descriptor, event ->
-        if (event.destination == TestOutputEvent.Destination.StdErr) {
-            stderrMessages.add(event.message)
-        }
-    }
-    testTask.doLast {
-        def stdoutText = stderrMessages.join '\n'
-        if (!stdoutText.contains("Mockito is currently self-attaching to enable the inline-mock-maker.")) {
-            throw new GradleException("Mockito should emit a message when self-attaching")
-        }
-    }
-}
diff --git a/mockito-integration-tests/java-21-tests/build.gradle.kts b/mockito-integration-tests/java-21-tests/build.gradle.kts
new file mode 100644
index 0000000000..0b43dda5d4
--- /dev/null
+++ b/mockito-integration-tests/java-21-tests/build.gradle.kts
@@ -0,0 +1,96 @@
+plugins {
+    id("java")
+    id("mockito.test-conventions")
+}
+
+description = "Test suite for Java 21 Mockito"
+
+val bytebuddyAgent: Configuration by configurations.creating
+
+dependencies {
+    implementation(project(":mockito-core"))
+    testImplementation(libs.junit4)
+    testImplementation(libs.assertj)
+    bytebuddyAgent(libs.bytebuddy.agent) { isTransitive = false }
+}
+
+java {
+    sourceCompatibility = JavaVersion.VERSION_21
+    targetCompatibility = JavaVersion.VERSION_21
+    toolchain {
+        languageVersion = JavaLanguageVersion.of(21)
+    }
+}
+
+tasks {
+    val testWithBytebuddyAgent by registering(Test::class) {
+        if (!JavaVersion.current().isCompatibleWith(JavaVersion.VERSION_21)) {
+            enabled = false
+        } else {
+            jvmArgs(
+                "-javaagent:${bytebuddyAgent.asPath}",
+                // "-Djdk.instrument.traceUsage",
+            )
+        }
+    }
+
+    val testWithMockitoAgent by registering(Test::class) {
+        dependsOn(":mockito-core:jar")
+        if (!JavaVersion.current().isCompatibleWith(JavaVersion.VERSION_21)) {
+            enabled = false
+        } else {
+            jvmArgumentProviders.add(
+                CommandLineArgumentProvider {
+                    listOf(
+                        "-javaagent:${project(":mockito-core").tasks.jar.get().archiveFile.get()}"
+                        // "-Djdk.instrument.traceUsage",
+                    )
+                }
+            )
+        }
+        failIfStdErrWarningOnDynamicallyLoadedAgent(this)
+    }
+
+    named<Test>("test") {
+        dependsOn(
+            testWithMockitoAgent,
+            testWithBytebuddyAgent,
+        )
+        isEnabled = JavaVersion.current().isCompatibleWith(JavaVersion.VERSION_21)
+
+        expectStdErrWhenDynamicallyLoadedAgent(this)
+    }
+}
+
+private fun failIfStdErrWarningOnDynamicallyLoadedAgent(testTask: Test) {
+    val stderrMessages = mutableListOf<String>()
+    testTask.addTestOutputListener { _, event ->
+        if (event.destination == TestOutputEvent.Destination.StdErr) {
+            stderrMessages.add(event.message)
+        }
+    }
+    testTask.doLast {
+        val stderrText = stderrMessages.joinToString(separator = "\n")
+        if (stderrText.contains("A Java agent has been loaded dynamically")
+            && stderrText.contains("net.bytebuddy/byte-buddy-agent")
+            && stderrText.contains("If a serviceability tool is in use, please run with -XX:+EnableDynamicAgentLoading to hide this warning")
+        ) {
+            throw GradleException("JDK should no emit warning when mockito is set as agent and -XX:+EnableDynamicAgentLoading is not set")
+        }
+    }
+}
+
+private fun expectStdErrWhenDynamicallyLoadedAgent(testTask: Test) {
+    val stderrMessages = mutableListOf<String>()
+    testTask.addTestOutputListener { _, event ->
+        if (event.destination == TestOutputEvent.Destination.StdErr) {
+            stderrMessages.add(event.message)
+        }
+    }
+    testTask.doLast {
+        val stdoutText = stderrMessages.joinToString("\n")
+        if (!stdoutText.contains("Mockito is currently self-attaching to enable the inline-mock-maker.")) {
+            throw GradleException("Mockito should emit a message when self-attaching")
+        }
+    }
+}
diff --git a/mockito-integration-tests/junit-jupiter-extension-tests/build.gradle b/mockito-integration-tests/junit-jupiter-extension-tests/build.gradle
deleted file mode 100644
index 870e46b765..0000000000
--- a/mockito-integration-tests/junit-jupiter-extension-tests/build.gradle
+++ /dev/null
@@ -1,18 +0,0 @@
-plugins {
-    id("java")
-    id("mockito.test-conventions")
-}
-
-description = "End-to-end tests for automatic registration of MockitoExtension."
-
-dependencies {
-    testImplementation project(":mockito-extensions:mockito-junit-jupiter")
-    testImplementation libs.assertj
-    testImplementation libs.junit.jupiter.api
-    testRuntimeOnly libs.junit.jupiter.engine
-    testRuntimeOnly libs.junit.platform.launcher
-}
-
-test {
-    useJUnitPlatform()
-}
diff --git a/mockito-integration-tests/junit-jupiter-extension-tests/build.gradle.kts b/mockito-integration-tests/junit-jupiter-extension-tests/build.gradle.kts
new file mode 100644
index 0000000000..1a2dede0ac
--- /dev/null
+++ b/mockito-integration-tests/junit-jupiter-extension-tests/build.gradle.kts
@@ -0,0 +1,20 @@
+plugins {
+    id("java")
+    id("mockito.test-conventions")
+}
+
+description = "End-to-end tests for automatic registration of MockitoExtension."
+
+dependencies {
+    testImplementation(project(":mockito-extensions:mockito-junit-jupiter"))
+    testImplementation(libs.assertj)
+    testImplementation(libs.junit.jupiter.api)
+    testRuntimeOnly(libs.junit.jupiter.engine)
+    testRuntimeOnly(libs.junit.platform.launcher)
+}
+
+tasks {
+    test {
+        useJUnitPlatform()
+    }
+}
diff --git a/mockito-integration-tests/junit-jupiter-inline-mock-maker-extension-tests/build.gradle b/mockito-integration-tests/junit-jupiter-inline-mock-maker-extension-tests/build.gradle
deleted file mode 100644
index 66daf3d801..0000000000
--- a/mockito-integration-tests/junit-jupiter-inline-mock-maker-extension-tests/build.gradle
+++ /dev/null
@@ -1,18 +0,0 @@
-plugins {
-    id("java")
-    id("mockito.test-conventions")
-}
-
-description = "End-to-end tests for automatic registration of MockitoExtension with the inline mock maker."
-
-dependencies {
-    testImplementation project(":mockito-extensions:mockito-junit-jupiter")
-    testImplementation libs.assertj
-    testImplementation libs.junit.jupiter.api
-    testRuntimeOnly libs.junit.jupiter.engine
-    testRuntimeOnly libs.junit.platform.launcher
-}
-
-test {
-    useJUnitPlatform()
-}
diff --git a/mockito-integration-tests/junit-jupiter-inline-mock-maker-extension-tests/build.gradle.kts b/mockito-integration-tests/junit-jupiter-inline-mock-maker-extension-tests/build.gradle.kts
new file mode 100644
index 0000000000..3b2efb435a
--- /dev/null
+++ b/mockito-integration-tests/junit-jupiter-inline-mock-maker-extension-tests/build.gradle.kts
@@ -0,0 +1,20 @@
+plugins {
+    id("java")
+    id("mockito.test-conventions")
+}
+
+description = "End-to-end tests for automatic registration of MockitoExtension with the inline mock maker."
+
+dependencies {
+    testImplementation(project(":mockito-extensions:mockito-junit-jupiter"))
+    testImplementation(libs.assertj)
+    testImplementation(libs.junit.jupiter.api)
+    testRuntimeOnly(libs.junit.jupiter.engine)
+    testRuntimeOnly(libs.junit.platform.launcher)
+}
+
+tasks{
+    test {
+        useJUnitPlatform()
+    }
+}
diff --git a/mockito-integration-tests/junit-jupiter-parallel-tests/build.gradle b/mockito-integration-tests/junit-jupiter-parallel-tests/build.gradle
deleted file mode 100644
index bd06bc0f86..0000000000
--- a/mockito-integration-tests/junit-jupiter-parallel-tests/build.gradle
+++ /dev/null
@@ -1,17 +0,0 @@
-plugins {
-    id("java")
-    id("mockito.test-conventions")
-}
-
-description = "Tests that require fine tuned parallel settings for JUnit Jupiter (bug #1630)"
-
-dependencies {
-    testImplementation libs.junit.jupiter.api
-    testImplementation project(":mockito-extensions:mockito-junit-jupiter")
-    testRuntimeOnly libs.junit.jupiter.engine
-    testRuntimeOnly libs.junit.platform.launcher
-}
-
-test {
-    useJUnitPlatform()
-}
diff --git a/mockito-integration-tests/junit-jupiter-parallel-tests/build.gradle.kts b/mockito-integration-tests/junit-jupiter-parallel-tests/build.gradle.kts
new file mode 100644
index 0000000000..ac0c3a75a1
--- /dev/null
+++ b/mockito-integration-tests/junit-jupiter-parallel-tests/build.gradle.kts
@@ -0,0 +1,19 @@
+plugins {
+    id("java")
+    id("mockito.test-conventions")
+}
+
+description = "Tests that require fine tuned parallel settings for JUnit Jupiter (bug #1630)"
+
+dependencies {
+    testImplementation(libs.junit.jupiter.api)
+    testImplementation(project(":mockito-extensions:mockito-junit-jupiter"))
+    testRuntimeOnly(libs.junit.jupiter.engine)
+    testRuntimeOnly(libs.junit.platform.launcher)
+}
+
+tasks {
+    test {
+        useJUnitPlatform()
+    }
+}
diff --git a/mockito-integration-tests/kotlin-release-coroutines-tests/build.gradle b/mockito-integration-tests/kotlin-release-coroutines-tests/build.gradle
deleted file mode 100644
index b31777a80a..0000000000
--- a/mockito-integration-tests/kotlin-release-coroutines-tests/build.gradle
+++ /dev/null
@@ -1,23 +0,0 @@
-import org.jetbrains.kotlin.gradle.dsl.JvmTarget
-import org.jetbrains.kotlin.gradle.tasks.KotlinCompile
-
-plugins {
-    id("org.jetbrains.kotlin.jvm")
-    id("mockito.test-conventions")
-}
-
-description = "Kotlin tests for Mockito."
-
-tasks.withType(KotlinCompile).configureEach {
-    compilerOptions {
-        jvmTarget = JvmTarget.JVM_11
-    }
-}
-
-dependencies {
-    testImplementation project(":mockito-core")
-    testImplementation libs.junit4
-
-    testImplementation libs.kotlin.stdlib
-    testImplementation libs.kotlin.coroutines
-}
diff --git a/mockito-integration-tests/kotlin-release-coroutines-tests/build.gradle.kts b/mockito-integration-tests/kotlin-release-coroutines-tests/build.gradle.kts
new file mode 100644
index 0000000000..e3a5d841eb
--- /dev/null
+++ b/mockito-integration-tests/kotlin-release-coroutines-tests/build.gradle.kts
@@ -0,0 +1,25 @@
+import org.jetbrains.kotlin.gradle.dsl.JvmTarget
+import org.jetbrains.kotlin.gradle.tasks.KotlinCompile
+
+plugins {
+    id("org.jetbrains.kotlin.jvm")
+    id("mockito.test-conventions")
+}
+
+description = "Kotlin tests for Mockito."
+
+dependencies {
+    testImplementation(project(":mockito-core"))
+    testImplementation(libs.junit4)
+
+    testImplementation(libs.kotlin.stdlib)
+    testImplementation(libs.kotlin.coroutines)
+}
+
+tasks {
+    withType<KotlinCompile> {
+        compilerOptions {
+            jvmTarget = JvmTarget.JVM_11
+        }
+    }
+}
diff --git a/mockito-integration-tests/kotlin-tests/build.gradle b/mockito-integration-tests/kotlin-tests/build.gradle
deleted file mode 100644
index b31777a80a..0000000000
--- a/mockito-integration-tests/kotlin-tests/build.gradle
+++ /dev/null
@@ -1,23 +0,0 @@
-import org.jetbrains.kotlin.gradle.dsl.JvmTarget
-import org.jetbrains.kotlin.gradle.tasks.KotlinCompile
-
-plugins {
-    id("org.jetbrains.kotlin.jvm")
-    id("mockito.test-conventions")
-}
-
-description = "Kotlin tests for Mockito."
-
-tasks.withType(KotlinCompile).configureEach {
-    compilerOptions {
-        jvmTarget = JvmTarget.JVM_11
-    }
-}
-
-dependencies {
-    testImplementation project(":mockito-core")
-    testImplementation libs.junit4
-
-    testImplementation libs.kotlin.stdlib
-    testImplementation libs.kotlin.coroutines
-}
diff --git a/mockito-integration-tests/kotlin-tests/build.gradle.kts b/mockito-integration-tests/kotlin-tests/build.gradle.kts
new file mode 100644
index 0000000000..daee6010aa
--- /dev/null
+++ b/mockito-integration-tests/kotlin-tests/build.gradle.kts
@@ -0,0 +1,26 @@
+import org.jetbrains.kotlin.gradle.dsl.JvmTarget
+import org.jetbrains.kotlin.gradle.tasks.KotlinCompile
+
+plugins {
+    id("org.jetbrains.kotlin.jvm")
+    id("mockito.test-conventions")
+}
+
+description = "Kotlin tests for Mockito."
+
+dependencies {
+    testImplementation(project(":mockito-core"))
+    testImplementation(libs.junit4)
+
+    testImplementation(libs.kotlin.stdlib)
+    testImplementation(libs.kotlin.coroutines)
+}
+
+tasks {
+    withType<KotlinCompile> {
+        compilerOptions {
+            jvmTarget = JvmTarget.JVM_11
+        }
+    }
+}
+
diff --git a/mockito-integration-tests/memory-tests/build.gradle b/mockito-integration-tests/memory-tests/build.gradle
deleted file mode 100644
index 25b14ff028..0000000000
--- a/mockito-integration-tests/memory-tests/build.gradle
+++ /dev/null
@@ -1,16 +0,0 @@
-plugins {
-    id("java")
-    id("mockito.test-conventions")
-}
-
-description = "Test suite memory usage of Mockito"
-
-dependencies {
-    implementation project(":mockito-core")
-    testImplementation libs.junit4
-    testImplementation libs.assertj
-}
-
-test {
-    maxHeapSize = "128m"
-}
diff --git a/mockito-integration-tests/memory-tests/build.gradle.kts b/mockito-integration-tests/memory-tests/build.gradle.kts
new file mode 100644
index 0000000000..fa4c6dfecc
--- /dev/null
+++ b/mockito-integration-tests/memory-tests/build.gradle.kts
@@ -0,0 +1,18 @@
+plugins {
+    id("java")
+    id("mockito.test-conventions")
+}
+
+description = "Test suite memory usage of Mockito"
+
+dependencies {
+    implementation(project(":mockito-core"))
+    testImplementation(libs.junit4)
+    testImplementation(libs.assertj)
+}
+
+tasks {
+    test {
+        maxHeapSize = "128m"
+    }
+}
diff --git a/mockito-integration-tests/module-tests/build.gradle b/mockito-integration-tests/module-tests/build.gradle.kts
similarity index 54%
rename from mockito-integration-tests/module-tests/build.gradle
rename to mockito-integration-tests/module-tests/build.gradle.kts
index 35f2cafe69..c8435d23f3 100644
--- a/mockito-integration-tests/module-tests/build.gradle
+++ b/mockito-integration-tests/module-tests/build.gradle.kts
@@ -6,7 +6,7 @@ plugins {
 description = "Test suite for Java 9 modules with Mockito"
 
 dependencies {
-    implementation project(":mockito-core")
-    testImplementation libs.junit4
-    testImplementation libs.assertj
+    implementation(project(":mockito-core"))
+    testImplementation(libs.junit4)
+    testImplementation(libs.assertj)
 }
diff --git a/mockito-integration-tests/osgi-tests/build.gradle b/mockito-integration-tests/osgi-tests/build.gradle
deleted file mode 100644
index 64a5847be2..0000000000
--- a/mockito-integration-tests/osgi-tests/build.gradle
+++ /dev/null
@@ -1,58 +0,0 @@
-plugins {
-    id("java")
-    id("mockito.test-conventions")
-}
-
-apply from: "osgi-test-bundles.gradle"
-
-description = "Test suite for OSGi framework with Mockito"
-
-dependencies {
-    testImplementation project(":mockito-core")
-    testImplementation libs.junit4
-    testImplementation libs.osgi
-
-    testRuntimeOnly libs.equinox
-}
-
-configurations {
-    testRuntimeBundles
-}
-
-dependencies {
-    testRuntimeBundles project(":mockito-core")
-    testRuntimeBundles libs.bytebuddy
-    testRuntimeBundles libs.objenesis
-    testRuntimeBundles tasks.testBundle.outputs.files
-    testRuntimeBundles tasks.otherBundle.outputs.files
-}
-
-test {
-    jvmArgumentProviders.add(
-        new RuntimeBundlesProvider(files: configurations.testRuntimeBundles.asFileTree)
-    )
-    dependsOn configurations.testRuntimeBundles
-    inputs.files(sourceSets.testBundle.allSource)
-        .withPathSensitivity(PathSensitivity.RELATIVE)
-        .withPropertyName('testBundleSources')
-    inputs.files(sourceSets.otherBundle.allSource)
-        .withPathSensitivity(PathSensitivity.RELATIVE)
-        .withPropertyName('otherBundleSources')
-    useJUnit()
-}
-
-/**
- * A helper class to pass classpath elements as relative paths. This allows the build
- * to be checked out in different locations on the file system and still hit the cache.
- */
-class RuntimeBundlesProvider implements CommandLineArgumentProvider {
-    @InputFiles
-    @PathSensitive(PathSensitivity.RELATIVE)
-    FileTree files
-
-    @Override
-    Iterable<String> asArguments() {
-        String[] absolutePaths = files.stream().map {it.absolutePath}.toArray()
-        ["-DtestRuntimeBundles=${absolutePaths.join(File.pathSeparator)}".toString()]
-    }
-}
diff --git a/mockito-integration-tests/osgi-tests/build.gradle.kts b/mockito-integration-tests/osgi-tests/build.gradle.kts
new file mode 100644
index 0000000000..d53aa47a10
--- /dev/null
+++ b/mockito-integration-tests/osgi-tests/build.gradle.kts
@@ -0,0 +1,90 @@
+import aQute.bnd.gradle.Bundle
+
+plugins {
+    id("java")
+    id("mockito.test-conventions")
+    id("mockito.osgi-conventions")
+}
+
+description = "Test suite for OSGi framework with Mockito"
+
+dependencies {
+    testImplementation(project(":mockito-core"))
+    testImplementation(libs.junit4)
+    testImplementation(libs.osgi)
+
+    testRuntimeOnly(libs.equinox)
+}
+
+val testRuntimeBundles: Configuration by configurations.creating
+
+val (otherBundle, otherBundleTask) = configureOsgiBundle(project, "otherBundle")
+val (testBundle, testBundleTask) = configureOsgiBundle(project, "testBundle") {
+    add("testBundleImplementation", project(":mockito-core"))
+    add("testBundleImplementation", project.libs.junit4)
+    add("testBundleImplementation", otherBundle.output)
+}
+
+dependencies {
+    testRuntimeBundles(project(":mockito-core"))
+    testRuntimeBundles(libs.bytebuddy)
+    testRuntimeBundles(libs.objenesis)
+
+    testRuntimeBundles(testBundleTask.map { it.outputs.files })
+    testRuntimeBundles(otherBundleTask.map { it.outputs.files })
+}
+
+tasks {
+    test {
+        jvmArgumentProviders.add(RuntimeBundlesProvider(testRuntimeBundles.asFileTree))
+        dependsOn(testRuntimeBundles)
+
+        inputs.files(testBundle.allSource)
+            .withPathSensitivity(PathSensitivity.RELATIVE)
+            .withPropertyName("testBundleSources")
+
+        inputs.files(otherBundle.allSource)
+            .withPathSensitivity(PathSensitivity.RELATIVE)
+            .withPropertyName("otherBundleSources")
+        useJUnit()
+    }
+}
+
+/**
+ * A helper class to pass classpath elements as relative paths. This allows the build
+ * to be checked out in different locations on the file system and still hit the cache.
+ */
+class RuntimeBundlesProvider(
+    @InputFiles
+    @PathSensitive(PathSensitivity.RELATIVE)
+    val files: FileTree
+) : CommandLineArgumentProvider {
+    override fun asArguments(): Iterable<String> {
+        val absolutePaths = files.files.map { it.absolutePath }
+        return listOf("-DtestRuntimeBundles=${absolutePaths.joinToString(separator = File.pathSeparator)}")
+    }
+}
+
+fun configureOsgiBundle(project: Project, bundleName: String, dependencyConfig: DependencyHandler.() -> Unit = {}): Pair<SourceSet, TaskProvider<Bundle>> {
+    val bundle = project.sourceSets.create(bundleName)
+
+    project.dependencies {
+        dependencyConfig()
+    }
+
+    val bundleTask = project.tasks.register(bundleName, Bundle::class) {
+        archiveAppendix = name
+        bundle { // this: BundleTaskExtension
+            bnd(
+                """
+                    Bundle-SymbolicName: $name
+                    -exportcontents: *
+                    """.trimIndent()
+            )
+        }
+        from(bundle.output)
+    }
+
+    return bundle to bundleTask
+}
+
diff --git a/mockito-integration-tests/osgi-tests/osgi-test-bundles.gradle b/mockito-integration-tests/osgi-tests/osgi-test-bundles.gradle
deleted file mode 100644
index 2e14f5ca28..0000000000
--- a/mockito-integration-tests/osgi-tests/osgi-test-bundles.gradle
+++ /dev/null
@@ -1,41 +0,0 @@
-buildscript {
-    repositories {
-        mavenCentral()
-    }
-    dependencies {
-        classpath libs.bnd.gradle
-    }
-}
-
-// Test bundles for OSGi tests
-
-sourceSets {
-    testBundle
-    otherBundle
-}
-
-dependencies {
-    testBundleImplementation project(":mockito-core")
-    testBundleImplementation libs.junit4
-    testBundleImplementation sourceSets.otherBundle.output
-}
-
-import aQute.bnd.gradle.Bundle
-
-task testBundle(type: Bundle) {
-    from sourceSets.testBundle.output
-}
-
-tasks.register('otherBundle', Bundle) {
-    from sourceSets.otherBundle.output
-}
-
-tasks.withType(Bundle).configureEach {
-    archiveAppendix = name
-    bundle { // this: BundleTaskExtension
-        bnd = """
-            Bundle-SymbolicName: $name
-            -exportcontents: *
-        """.stripIndent()
-    }
-}
diff --git a/mockito-integration-tests/programmatic-tests/build.gradle b/mockito-integration-tests/programmatic-tests/build.gradle
deleted file mode 100644
index d9539eea64..0000000000
--- a/mockito-integration-tests/programmatic-tests/build.gradle
+++ /dev/null
@@ -1,16 +0,0 @@
-plugins {
-    id("java")
-    id("mockito.test-conventions")
-}
-
-description = "Test suite for exercising programmatic mock maker in Mockito"
-
-dependencies {
-    implementation project(":mockito-core")
-    testImplementation libs.junit4
-    testImplementation libs.assertj
-}
-
-test {
-  forkEvery = 1
-}
diff --git a/mockito-integration-tests/programmatic-tests/build.gradle.kts b/mockito-integration-tests/programmatic-tests/build.gradle.kts
new file mode 100644
index 0000000000..e17312551b
--- /dev/null
+++ b/mockito-integration-tests/programmatic-tests/build.gradle.kts
@@ -0,0 +1,18 @@
+plugins {
+    id("java")
+    id("mockito.test-conventions")
+}
+
+description = "Test suite for exercising programmatic mock maker in Mockito"
+
+dependencies {
+    implementation(project(":mockito-core"))
+    testImplementation(libs.junit4)
+    testImplementation(libs.assertj)
+}
+
+tasks {
+    test {
+        forkEvery = 1
+    }
+}
diff --git a/settings.gradle.kts b/settings.gradle.kts
index fc3c9f4c0d..6de4caa468 100644
--- a/settings.gradle.kts
+++ b/settings.gradle.kts
@@ -48,7 +48,7 @@ include(
 
 // https://developer.android.com/studio/command-line/variables#envar
 // https://developer.android.com/studio/build#properties-files
-if (System.getenv("ANDROID_HOME") != null || File("local.properties").exists()) {
+if (providers.environmentVariable("ANDROID_HOME").isPresent || File("local.properties").exists()) {
     include("mockito-integration-tests:android-tests")
 } else {
     logger.info("Not including android test project due to missing SDK configuration")
@@ -66,6 +66,6 @@ develocity {
 
 buildCache {
     local {
-        isEnabled = !System.getenv().containsKey("CI")
+        isEnabled = !providers.environmentVariable("CI").isPresent
     }
 }
