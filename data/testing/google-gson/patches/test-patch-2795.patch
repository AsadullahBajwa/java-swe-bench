diff --git a/gson/src/test/java/com/google/gson/integration/OSGiManifestIT.java b/gson/src/test/java/com/google/gson/integration/OSGiManifestIT.java
index 9f6c5334aa..fd407279de 100644
--- a/gson/src/test/java/com/google/gson/integration/OSGiManifestIT.java
+++ b/gson/src/test/java/com/google/gson/integration/OSGiManifestIT.java
@@ -114,7 +114,10 @@ public void testImports() throws Exception {
         .containsExactly(
             // Dependency on JDK's sun.misc.Unsafe should be optional
             "sun.misc;resolution:=optional",
-            "com.google.errorprone.annotations;version=\"" + errorProneVersionRange + "\"");
+            // Dependency on error prone should be optional
+            "com.google.errorprone.annotations;resolution:=optional;version=\""
+                + errorProneVersionRange
+                + "\"");
 
     // Should not contain any import for Gson's own packages, see
     // https://github.com/google/gson/pull/2735#issuecomment-2330047410
